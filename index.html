<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>战锤40K：虚空黎明 v0.3</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-container">
        <!-- 标题 -->
        <header class="game-header">
            <h1>⚔️ 战锤40K：虚空黎明</h1>
            <div class="subtitle">战争时代 · 荷鲁斯之乱 v0.3（AI增强版）</div>
        </header>

        <!-- 角色状态 -->
        <div class="status-panel">
            <div class="character-status">
                <div class="character-avatar">🦾</div>
                <div class="character-info">
                    <div class="character-name" id="charName">钛-7</div>
                    <div class="character-class" id="charClass">极限战士 Lv.1</div>
                    <div class="character-stats">
                        <span class="stat hp">❤️ <span id="hpValue">100</span>/<span id="hpMax">100</span></span>
                        <span class="stat chaos">🔮 <span id="chaosValue">0</span></span>
                        <span class="stat faith">✨ <span id="faithValue">50</span></span>
                    </div>
                </div>
            </div>
            
            <!-- 资源面板 -->
            <div class="resource-panel">
                <div class="resource">
                    <span class="icon">📦</span>
                    <span class="name">物资</span>
                    <span class="value" id="materialValue">50</span>
                </div>
                <div class="resource">
                    <span class="icon">🧠</span>
                    <span class="name">情报</span>
                    <span class="value" id="intelligenceValue">10</span>
                </div>
                <div class="resource">
                    <span class="icon">⭐</span>
                    <span class="name">信仰</span>
                    <span class="value" id="faithPointsValue">0</span>
                </div>
            </div>
        </div>

        <!-- 混沌进度条 -->
        <div class="chaos-container">
            <div class="chaos-bar-label">
                <span>混沌侵蚀度</span>
                <span class="chaos-value"><span id="chaosBarValue">0</span>/100</span>
            </div>
            <div class="chaos-bar">
                <div class="chaos-fill" id="chaosFill" style="width: 0%"></div>
                <div class="chaos-marker" style="left: 20%">纯净</div>
                <div class="chaos-marker" style="left: 50%">中腐</div>
                <div class="chaos-marker" style="left: 80%">重腐</div>
            </div>
            <div class="chaos-phase-label" id="chaosPhaseLabel">当前阶段：纯净</div>
        </div>

        <!-- 任务卡区域 -->
        <div class="card-section" id="cardSection">
            <div class="section-title">🃏 当前任务</div>
            <div class="card-info">
                <span id="cardInfo">抽取任务卡牌...</span>
                <span id="cardTimer">剩余回合：3</span>
            </div>
            <div id="currentCardArea">
                <!-- 当前任务卡显示在这里 -->
            </div>
        </div>

        <!-- 调查系统（混沌卡） -->
        <div class="investigation-section" id="investigationSection" style="display: none;">
            <div class="section-title">🔍 调查模式 - 找出混沌内鬼</div>
            
            <div class="suspects-container">
                <!-- 嫌疑人列表 -->
                <div class="suspect-card" onclick="interrogate('tam')">
                    <div class="suspect-avatar">👨‍✈️</div>
                    <div class="suspect-info">
                        <div class="suspect-name">塔姆</div>
                        <div class="suspect-role">士兵</div>
                        <div class="suspect-status">
                            <span>可疑度: <span id="tamSuspicion">3</span>/10</span>
                            <span>信任度: <span id="tamTrust">5</span>/10</span>
                        </div>
                    </div>
                    <button class="action-btn-small">审问</button>
                </div>
                
                <div class="suspect-card" onclick="interrogate('carl')">
                    <div class="suspect-avatar">📦</div>
                    <div class="suspect-info">
                        <div class="suspect-name">卡尔</div>
                        <div class="suspect-role">军需官</div>
                        <div class="suspect-status">
                            <span>可疑度: <span id="carlSuspicion">5</span>/10</span>
                            <span>信任度: <span id="carlTrust">3</span>/10</span>
                        </div>
                    </div>
                    <button class="action-btn-small">审问</button>
                </div>
                
                <div class="suspect-card" onclick="interrogate('yuri')">
                    <div class="suspect-avatar">🔧</div>
                    <div class="suspect-info">
                        <div class="suspect-name">尤里</div>
                        <div class="suspect-role">技术神甫</div>
                        <div class="suspect-status">
                            <span>可疑度: <span id="yuriSuspicion">4</span>/10</span>
                            <span>信任度: <span id="yuriTrust">2</span>/10</span>
                        </div>
                    </div>
                    <button class="action-btn-small">审问</button>
                </div>
            </div>
            
            <!-- 证据列表 -->
            <div class="evidence-container">
                <div class="section-subtitle">📝 收集的线索</div>
                <div id="evidenceList">
                    <p class="empty-text">还没有线索...</p>
                </div>
            </div>
            
            <!-- 投票区域 -->
            <div class="voting-container">
                <div class="section-subtitle">🗳️ 投票处决</div>
                <p>收集足够线索后，你可以投票处决你认为的内鬼。</p>
                <div class="voting-buttons">
                    <button class="action-btn vote-btn" onclick="vote('tam')">处决塔姆</button>
                    <button class="action-btn vote-btn" onclick="vote('carl')">处决卡尔</button>
                    <button class="action-btn vote-btn" onclick="vote('yuri')">处决尤里</button>
                </div>
                <p class="warning">⚠️ 处决错误会增加混沌值！</p>
            </div>
        </div>

        <!-- 对话区域 -->
        <div class="dialog-panel" id="dialogPanel">
            <div class="dialog-title">📜 战况报告</div>
            <div class="dialog-content" id="dialogContent">
                <!-- 对话消息动态添加 -->
            </div>
        </div>

        <!-- 追随者面板 -->
        <div class="followers-section">
            <div class="section-title">👥 追随者</div>
            <div class="followers-panel" id="followersPanel">
                <p class="empty-text">还没有追随者...</p>
            </div>
        </div>

        <!-- 行动面板 -->
        <div class="action-panel">
            <div class="action-title">🎮 行动</div>
            
            <div class="action-categories">
                <button class="action-category" onclick="showCategory('system')">
                    <span class="category-icon">⚙️</span>
                    <span class="category-name">系统</span>
                </button>
                <button class="action-category" onclick="showCategory('investigation')">
                    <span class="category-icon">🔍</span>
                    <span class="category-name">调查</span>
                </button>
                <button class="action-category" onclick="showCategory('faith')">
                    <span class="category-icon">✨</span>
                    <span class="category-name">信仰</span>
                </button>
                <button class="action-category" onclick="showCategory('devotion')">
                    <span class="category-icon">💕</span>
                    <span class="category-name">眷属</span>
                </button>
            </div>
            
            <!-- 系统行动 -->
            <div class="action-list" id="system-actions" style="display: grid;">
                <button class="action-btn" onclick="saveGame()">
                    💾 存档
                </button>
                <button class="action-btn" onclick="loadGame()">
                    📂 读档
                </button>
                <button class="action-btn" onclick="showFullStatus()">
                    📊 查看完整状态
                </button>
                <button class="action-btn" onclick="endTurn()">
                    ⏭️ 回合结束
                </button>
                <button class="action-btn danger" onclick="resetGame()">
                    🔄 重置游戏
                </button>
            </div>
            
            <!-- 调查行动 -->
            <div class="action-list" id="investigation-actions" style="display: grid;">
                <button class="action-btn" onclick="interrogate('tam')">
                    💬 审问塔姆
                </button>
                <button class="action-btn" onclick="interrogate('carl')">
                    💬 审问卡尔
                </button>
                <button class="action-btn" onclick="interrogate('yuri')">
                    💬 审问尤里
                </button>
            </div>
            
            <!-- 信仰行动 -->
            <div class="action-list" id="faith-actions" style="display: grid;">
                <button class="action-btn" onclick="performFaithAction('pray')">
                    🙏 祈祷
                    <span class="action-cost">消耗5情报</span>
                </button>
                <button class="action-btn" onclick="performFaithAction('purify')">
                    ✨ 净化仪式
                    <span class="action-cost">消耗20物资</span>
                </button>
            </div>
            
            <!-- 眷属行动 -->
            <div class="action-list" id="devotion-actions" style="display: grid;">
                <button class="action-btn" onclick="performDevotionAction('gift')">
                    🎁 送礼
                    <span class="action-cost">消耗10物资</span>
                </button>
                <button class="action-btn" onclick="performDevotionAction('help')">
                    🤝 帮助
                    <span class="action-cost">消耗15物资</span>
                </button>
            </div>
        </div>

        <!-- 进度面板 -->
        <div class="progress-panel">
            <div class="progress-item">
                <span class="progress-label">回合</span>
                <span class="progress-value" id="turnNumber">1</span>
                <span class="progress-max">/14</span>
            </div>
            <div class="progress-item">
                <span class="progress-label">混沌值</span>
                <span class="progress-value" id="chaosProgress">0</span>
                <span class="progress-max">/100</span>
            </div>
        </div>
        
        <!-- 与伊莲娜对话按钮 -->
        <div class="elena-chat-section">
            <button class="elena-btn" onclick="showElenaChat()">
                💬 与伊莲娜对话
            </button>
        </div>
        
        <!-- 伊莲娜对话弹窗 -->
        <div class="elena-popup" id="elenaPopup" style="display: none;">
            <div class="elena-popup-content">
                <div class="elena-header">
                    <span class="elena-avatar">👩</span>
                    <span class="elena-name">伊莲娜</span>
                    <button class="close-btn" onclick="hideElenaChat()">×</button>
                </div>
                <div class="elena-messages" id="elenaMessages">
                    <div class="elena-message">
                        嘿，小鬼！有什么需要姐姐帮忙的吗？
                    </div>
                </div>
                <div class="elena-quick-questions">
                    <button onclick="askElena('card')">这张卡是什么？</button>
                    <button onclick="askElena('chaos')">混沌值是什么？</button>
                    <button onclick="askElena('strategy')">现在该怎么做？</button>
                    <button onclick="askElena('general')">游戏怎么玩？</button>
                </div>
                <div class="elena-input-area">
                    <input type="text" id="elenaInput" placeholder="输入你的问题..." onkeypress="if(event.key==='Enter') sendToElena()">
                    <button onclick="sendToElena()">发送</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 加载JS模块 -->
    <script src="js/presetDialogues.js"></script>
    <script src="js/aiSystem.js"></script>
    <script src="js/gameState.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
